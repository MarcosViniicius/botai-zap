# ğŸ¤– WhatsApp Bot AI

Um bot inteligente para WhatsApp que utiliza a API da OpenAI para conversas naturais, processamento de comandos e transcriÃ§Ã£o de Ã¡udio.

## ğŸ“‹ DescriÃ§Ã£o

Este projeto implementa um assistente virtual no WhatsApp capaz de:
- Manter conversas contextuais usando GPT
- Processar comandos especÃ­ficos (/stats, etc.)
- Transcrever mensagens de Ã¡udio
- Gerar respostas em Ã¡udio
- Acelerar Ã¡udio para melhor processamento

## âœ¨ Funcionalidades

- **Chat Inteligente**: Conversas naturais com histÃ³rico mantido
- **Comandos Especiais**: Diversos comandos para funcionalidades extras
- **Processamento de Ãudio**: TranscriÃ§Ã£o e resposta em Ã¡udio
- **HistÃ³rico de Conversa**: MantÃ©m contexto entre mensagens
- **Debug de Tokens**: Monitoramento de uso da API OpenAI
- **Runtime em Background**: ExecuÃ§Ã£o contÃ­nua com PM2

## ğŸ”§ PrÃ©-requisitos

- Node.js (versÃ£o 16 ou superior)
- Bun (recomendado) ou npm
- PM2 (para execuÃ§Ã£o em background)
- Conta OpenAI com API key
- WhatsApp Web
- ffmpeg-static (incluÃ­do automaticamente)

## ğŸš€ InstalaÃ§Ã£o

1. Clone o repositÃ³rio:
```bash
git clone <url-do-repositorio>
cd botai-zap
```

2. Instale as dependÃªncias:
```bash
bun install
# ou
npm install
```

3. Instale o PM2 globalmente:
```bash
bun add -g pm2
# ou
npm install -g pm2
```

## âš™ï¸ ConfiguraÃ§Ã£o

1. Copie o arquivo de exemplo:
```bash
cp .env.example .env
```

2. Configure as variÃ¡veis no `.env`:
```env
APIKEY=sua-api-key-openai-aqui
DEBUG_TOKENS=false
MAX_HISTORY_LENGTH=20
FILE_DATA_PATH='./src/logs/whatsappAuth' // Local personalizÃ¡vel.
```

## ğŸ¯ Uso

### ExecuÃ§Ã£o Simples (Desenvolvimento)

```bash
bun start
# ou
npm start
```

### ExecuÃ§Ã£o em Background com PM2 (ProduÃ§Ã£o)

1. **Iniciar o bot em background:**
```bash
bun run startpm2
```

2. **Para visualizar os logs e escanear o QR code:**
```bash
bun run logspm2
```

3. **Outros comandos PM2 disponÃ­veis:**
```bash
# Parar o bot
bun run stoppm2

# Reiniciar o bot
bun run restartpm2

# Verificar status
bun run statuspm2

# Ver logs
bun run logspm2
```

> **âš ï¸ Importante**: Ao executar com PM2, vocÃª precisarÃ¡ usar o comando `bun run logspm2` para visualizar o QR code na primeira configuraÃ§Ã£o.

## ğŸ“ Comandos DisponÃ­veis

- `/stats` - Exibe estatÃ­sticas do bot

## ğŸ§ª Desenvolvimento

### Executar Testes

```bash
bun run test
# ou
npm test
```

### Build

```bash
bun run build
# ou
npm run build
```

### Desenvolvimento

```bash
bun run dev
# ou
npm run dev
```

## ğŸ“ Estrutura do Projeto

```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ openaiService.ts      # IntegraÃ§Ã£o com OpenAI
â”‚   â”œâ”€â”€ whatsappService.ts    # LÃ³gica do WhatsApp
â”‚   â””â”€â”€ chatCommands.ts       # Processamento de comandos
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ historyModel.ts       # Gerenciamento de histÃ³rico
â”‚   â”œâ”€â”€ tokenDebugModel.ts    # Debug de tokens
â”‚   â””â”€â”€ accelerateAudioModel.ts # Processamento de Ã¡udio
â”œâ”€â”€ types/
â”‚   â””â”€â”€ ffmpeg-static.d.ts    # Tipos TypeScript para ffmpeg-static
â””â”€â”€ tests/                    # Testes automatizados
```

## ğŸš€ Melhorias de Performance

- **Removido Docker**: A configuraÃ§Ã£o Docker foi removida pois estava impactando negativamente na performance da aplicaÃ§Ã£o
- **QR Code Otimizado**: SubstituÃ­do o mÃ³dulo QRCode pelo `qrcode-terminal`, especÃ­fico para terminais e mais eficiente
- **PM2 Integration**: Runtime em background com PM2 para melhor estabilidade e gerenciamento de processos

## ğŸ”’ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a ISC.

## ğŸ¤ ContribuiÃ§Ã£o

ContribuiÃ§Ãµes sÃ£o bem-vindas! Sinta-se Ã  vontade para abrir issues e pull requests.

## âš ï¸ Avisos

- Este projeto utiliza a API da OpenAI, que tem custos associados
- Mantenha suas chaves de API seguras
- Use responsavelmente e respeite os termos de serviÃ§o
- Para execuÃ§Ã£o em produÃ§Ã£o, recomenda-se o uso do PM2